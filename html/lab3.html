<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 3: Quality Evaluation Hands-on - Bioinformatics 2026</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="../index.html" class="logo">Bioinformatics Specialization Program - KAUST Academy</a>
            <button class="nav-toggle" onclick="toggleNav()">&#9776;</button>
            <ul id="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="schedule.html">Schedule</a></li>
                <li><a href="labs.html" class="active">Labs</a></li>
                <li><a href="setup.html">Setup</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="breadcrumbs">
            <a href="../index.html">Home</a> / <a href="labs.html">Labs</a> / Lab 3
        </div>

        <div class="lab-header">
            <h1>Lab 3: Quality Evaluation Hands-on</h1>
            <p class="lab-meta">Day 2 | Duration: 45 minutes</p>
        </div>

        <section>
            <h2>Objectives</h2>
            <ul>
                <li>Run FastQC to generate comprehensive quality reports</li>
                <li>Use fastp for quick quality overview and statistics</li>
                <li>Interpret quality metrics and identify potential issues</li>
                <li>Understand Phred quality scores and their implications</li>
            </ul>
        </section>

        <section>
            <h2>Background</h2>
            <p>Quality evaluation is the first step in any sequencing data analysis pipeline. Poor quality data can lead to incorrect conclusions, so it's crucial to assess data quality before proceeding. We will use two popular tools:</p>
            <ul>
                <li><strong>FastQC:</strong> Generates detailed HTML reports with multiple quality metrics</li>
                <li><strong>fastp:</strong> Fast all-in-one tool for QC and preprocessing</li>
            </ul>
        </section>

        <section>
            <h2>Instructions</h2>

            <div class="step" data-step="1">
                <h3>Set up your environment</h3>
                <pre><code># Navigate to project directory
cd ~/bioinformatics_course

# Activate conda environment
conda activate bioinformatics_course

# Verify tools are installed
fastqc --version
fastp --version</code></pre>
            </div>

            <div class="step" data-step="2">
                <h3>Run FastQC on raw data</h3>
                <p>FastQC analyzes FASTQ files and generates HTML reports with visualizations for various quality metrics.</p>
                <pre><code># Create output directory for QC reports
mkdir -p qc_reports/fastqc_raw

# Run FastQC on all FASTQ files
fastqc raw_data/*.fastq.gz -o qc_reports/fastqc_raw -t 4

# List generated reports
ls -la qc_reports/fastqc_raw/</code></pre>
                <div class="info-box tip">
                    <strong>Tip</strong>
                    The <code>-t 4</code> flag uses 4 threads for parallel processing. Adjust based on your system's available cores.
                </div>
            </div>

            <div class="step" data-step="3">
                <h3>Understanding FastQC output</h3>
                <p>FastQC generates two files per input: an HTML report and a ZIP file with raw data. Open the HTML files in a web browser to view the reports.</p>
                <pre><code># If using a graphical environment, open HTML report
# For remote servers, you may need to transfer files to your local machine

# On macOS:
open qc_reports/fastqc_raw/*.html

# On Linux with GUI:
firefox qc_reports/fastqc_raw/*.html &amp;</code></pre>

                <h4>Key FastQC Modules</h4>
                <ul>
                    <li><strong>Basic Statistics:</strong> Total sequences, sequence length, GC content</li>
                    <li><strong>Per Base Sequence Quality:</strong> Quality scores across read positions</li>
                    <li><strong>Per Sequence Quality Scores:</strong> Distribution of mean quality per read</li>
                    <li><strong>Per Base Sequence Content:</strong> Nucleotide composition at each position</li>
                    <li><strong>Sequence Duplication Levels:</strong> Degree of sequence duplication</li>
                    <li><strong>Overrepresented Sequences:</strong> Sequences occurring frequently (may indicate adapters)</li>
                    <li><strong>Adapter Content:</strong> Presence of adapter sequences</li>
                </ul>
            </div>

            <div class="step" data-step="4">
                <h3>Run fastp for quick quality check</h3>
                <p>fastp provides a quick overview and can also perform filtering in a single pass.</p>
                <pre><code># Run fastp in QC-only mode (no filtering)
mkdir -p qc_reports/fastp_raw

fastp \
    -i raw_data/sample_1.fastq.gz \
    -I raw_data/sample_2.fastq.gz \
    --html qc_reports/fastp_raw/sample_fastp.html \
    --json qc_reports/fastp_raw/sample_fastp.json \
    --disable_adapter_trimming \
    --disable_quality_filtering \
    --disable_length_filtering

# View the HTML report
open qc_reports/fastp_raw/sample_fastp.html</code></pre>
            </div>

            <div class="step" data-step="5">
                <h3>Interpret quality metrics</h3>
                <p>Learn to interpret the key quality metrics:</p>

                <h4>Per Base Quality</h4>
                <pre><code># Good quality: Most positions show Q30+ (green zone)
# Warning: Quality drops below Q20 at some positions (orange zone)
# Poor: Quality frequently below Q20 (red zone)

# Typical pattern: Quality decreases toward the 3' end of reads
# This is normal for Illumina sequencing</code></pre>

                <h4>GC Content</h4>
                <pre><code># Expected: Normal distribution centered around organism's GC%
# Human: ~40-42% GC content
# Deviation may indicate contamination or bias</code></pre>

                <h4>Duplication Levels</h4>
                <pre><code># RNA-seq often shows higher duplication than DNA-seq
# Highly expressed genes produce many identical reads
# Very high duplication (>50%) may indicate library issues</code></pre>
            </div>

            <div class="step" data-step="6">
                <h3>Extract summary statistics</h3>
                <p>Extract key statistics from FastQC results:</p>
                <pre><code># Extract summary from FastQC zip files
for zip in qc_reports/fastqc_raw/*.zip; do
    unzip -p $zip "*/summary.txt"
    echo "---"
done

# Parse fastp JSON for key metrics
cat qc_reports/fastp_raw/sample_fastp.json | python3 -c "
import json, sys
data = json.load(sys.stdin)
summary = data['summary']['before_filtering']
print(f\"Total reads: {summary['total_reads']}\"
print(f\"Total bases: {summary['total_bases']}\")
print(f\"Q20 rate: {summary['q20_rate']:.2%}\")
print(f\"Q30 rate: {summary['q30_rate']:.2%}\")
print(f\"GC content: {summary['gc_content']:.2%}\")
"</code></pre>
            </div>

            <div class="step" data-step="7">
                <h3>Identify potential issues</h3>
                <p>Common issues to look for and their solutions:</p>
                <table class="schedule-table">
                    <thead>
                        <tr>
                            <th>Issue</th>
                            <th>Indicator</th>
                            <th>Solution</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Low quality bases</td>
                            <td>Quality drops at 3' end</td>
                            <td>Quality trimming</td>
                        </tr>
                        <tr>
                            <td>Adapter contamination</td>
                            <td>Adapter sequences detected</td>
                            <td>Adapter trimming</td>
                        </tr>
                        <tr>
                            <td>Overrepresented sequences</td>
                            <td>Specific sequences flagged</td>
                            <td>Investigate source, may need filtering</td>
                        </tr>
                        <tr>
                            <td>Biased nucleotide content</td>
                            <td>Uneven base composition at start</td>
                            <td>Often normal for RNA-seq (random hexamer bias)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section>
            <h2>Summary</h2>
            <p>In this lab, you learned to:</p>
            <ul>
                <li>Run FastQC and fastp for quality assessment</li>
                <li>Interpret key quality metrics (per-base quality, GC content, duplication)</li>
                <li>Identify common sequencing issues and their solutions</li>
                <li>Extract summary statistics from QC reports</li>
            </ul>
        </section>

        <section>
            <h2>Next Steps</h2>
            <p>In <a href="lab4.html">Lab 4</a>, we will apply quality control measures (trimming, adapter removal) to improve data quality based on the issues identified here.</p>
        </section>
    </main>

    <footer>
        <p>Bioinformatics Specialization Program 2026 - KAUST Academy</p>
    </footer>

    <script>
        function toggleNav() {
            document.getElementById('nav-menu').classList.toggle('show');
        }
    </script>
</body>
</html>
