<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 2: Hands-on with Transcriptomics Data - Bioinformatics 2026</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="../index.html" class="logo">Bioinformatics 2026</a>
            <button class="nav-toggle" onclick="toggleNav()">&#9776;</button>
            <ul id="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="schedule.html">Schedule</a></li>
                <li><a href="labs.html" class="active">Labs</a></li>
                <li><a href="setup.html">Setup</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="breadcrumbs">
            <a href="../index.html">Home</a> / <a href="labs.html">Labs</a> / Lab 2
        </div>

        <div class="lab-header">
            <h1>Lab 2: Hands-on with Transcriptomics Data</h1>
            <p class="lab-meta">Day 1 | Duration: 45 minutes</p>
        </div>

        <section>
            <h2>Objectives</h2>
            <ul>
                <li>Explore RNA-seq datasets and understand their structure</li>
                <li>Navigate and examine FASTQ files efficiently</li>
                <li>Extract basic statistics from sequencing data</li>
                <li>Understand paired-end vs single-end sequencing data</li>
            </ul>
        </section>

        <section>
            <h2>Background</h2>
            <p>RNA-seq data is typically stored in FASTQ format. Understanding how to navigate and examine these files is essential before any analysis. In this lab, we will explore the data we downloaded in Lab 1 and learn useful command-line techniques for working with large sequencing files.</p>
        </section>

        <section>
            <h2>Instructions</h2>

            <div class="step" data-step="1">
                <h3>Navigate to your data directory</h3>
                <pre><code># Go to your project directory
cd ~/bioinformatics_course

# Activate conda environment
conda activate bioinformatics_course

# List your raw data files
ls -lh raw_data/</code></pre>
            </div>

            <div class="step" data-step="2">
                <h3>Understanding paired-end data</h3>
                <p>Paired-end sequencing reads DNA fragments from both ends. This creates two files per sample:</p>
                <ul>
                    <li><code>*_1.fastq.gz</code> - Forward reads (Read 1)</li>
                    <li><code>*_2.fastq.gz</code> - Reverse reads (Read 2)</li>
                </ul>
                <pre><code># Check that paired files have matching read counts
echo "Read 1 count:"
zcat raw_data/*_1.fastq.gz | wc -l | awk '{print $1/4}'

echo "Read 2 count:"
zcat raw_data/*_2.fastq.gz | wc -l | awk '{print $1/4}'</code></pre>
                <div class="info-box tip">
                    <strong>Tip</strong>
                    Paired files should always have exactly the same number of reads. If they don't match, something went wrong during download or data generation.
                </div>
            </div>

            <div class="step" data-step="3">
                <h3>Examine FASTQ structure in detail</h3>
                <p>Each read in a FASTQ file consists of 4 lines. Let's examine them:</p>
                <pre><code># View one complete read (4 lines)
zcat raw_data/*_1.fastq.gz | head -4

# Understanding the output:
# @SRR..../1 - Read identifier
# ATCGATCG... - The actual sequence
# + - Separator line
# IIIIIII... - Quality scores (Phred+33 encoded)</code></pre>

                <h4>Quality Score Encoding</h4>
                <p>Quality scores represent the probability of a sequencing error:</p>
                <pre><code># Quality score examples (Phred+33):
# ! = Q0  (worst quality)
# I = Q40 (very high quality)
# The formula: Q = -10 * log10(P_error)
# Q20 = 1% error rate
# Q30 = 0.1% error rate
# Q40 = 0.01% error rate</code></pre>
            </div>

            <div class="step" data-step="4">
                <h3>Extract read information</h3>
                <p>Let's extract useful information from our FASTQ files:</p>
                <pre><code># Get read length distribution
zcat raw_data/*_1.fastq.gz | awk 'NR%4==2 {print length($0)}' | sort | uniq -c | head -20

# Get first 10 read IDs
zcat raw_data/*_1.fastq.gz | awk 'NR%4==1' | head -10

# Check for specific sequences (e.g., adapter contamination)
zcat raw_data/*_1.fastq.gz | head -1000 | grep -c "AGATCGGAAGAG"</code></pre>
            </div>

            <div class="step" data-step="5">
                <h3>Working with large files efficiently</h3>
                <p>FASTQ files can be very large. Here are some techniques to work with them efficiently:</p>
                <pre><code># View first N reads without loading entire file
zcat raw_data/*_1.fastq.gz | head -40  # First 10 reads

# View last N reads
zcat raw_data/*_1.fastq.gz | tail -40  # Last 10 reads

# Sample random reads (useful for quick checks)
zcat raw_data/*_1.fastq.gz | paste - - - - | shuf | head -5 | tr '\t' '\n'

# Search for specific patterns
zcat raw_data/*_1.fastq.gz | grep -A 3 "pattern"</code></pre>
            </div>

            <div class="step" data-step="6">
                <h3>Calculate basic statistics</h3>
                <p>Let's calculate some basic statistics about our dataset:</p>
                <pre><code># Create a simple statistics script
cat > stats.sh << 'EOF'
#!/bin/bash
FILE=$1
echo "File: $FILE"
echo "Total reads: $(zcat $FILE | wc -l | awk '{print $1/4}')"
echo "Read length (first read): $(zcat $FILE | head -2 | tail -1 | wc -c)"
echo "File size: $(ls -lh $FILE | awk '{print $5}')"
EOF

chmod +x stats.sh

# Run on your files
./stats.sh raw_data/*_1.fastq.gz</code></pre>
            </div>

            <div class="step" data-step="7">
                <h3>Get comprehensive stats with SeqKit</h3>
                <p>SeqKit is a fast and powerful toolkit for FASTA/Q file manipulation. It provides comprehensive statistics in a single command.</p>
                <pre><code># Install SeqKit if not already installed
conda install -c bioconda seqkit -y

# Get basic statistics for all FASTQ files
seqkit stats raw_data/*.fastq.gz

# Output includes:
# - file: filename
# - format: file format (FASTQ)
# - type: sequence type (DNA)
# - num_seqs: number of sequences/reads
# - sum_len: total bases
# - min_len, avg_len, max_len: read length statistics</code></pre>

                <h4>Detailed statistics with SeqKit</h4>
                <pre><code># Get more detailed statistics (includes Q20/Q30 percentages)
seqkit stats -a raw_data/*.fastq.gz

# Additional columns with -a flag:
# - Q1, Q2, Q3: quartiles of sequence length
# - sum_gap: total gap length
# - N50: N50 statistic
# - Q20(%): percentage of bases with quality >= Q20
# - Q30(%): percentage of bases with quality >= Q30</code></pre>

                <h4>Other useful SeqKit commands</h4>
                <pre><code># Get GC content
seqkit fx2tab --name --gc raw_data/*_1.fastq.gz | head -10

# Get sequence length distribution
seqkit fx2tab --name --length raw_data/*_1.fastq.gz | \
    cut -f2 | sort | uniq -c | sort -rn | head -10

# Subsample reads (useful for quick tests)
seqkit sample -n 1000 raw_data/*_1.fastq.gz -o raw_data/sample_subset.fastq.gz

# Convert FASTQ to FASTA
seqkit fq2fa raw_data/*_1.fastq.gz -o raw_data/reads.fasta

# Search for sequences containing a pattern
seqkit grep -s -p "AGATCGGAAG" raw_data/*_1.fastq.gz | head -20</code></pre>
                <div class="info-box tip">
                    <strong>Tip</strong>
                    SeqKit is much faster than using shell commands for large files and provides more comprehensive statistics. It's a must-have tool for any bioinformatics workflow.
                </div>
            </div>

            <div class="step" data-step="8">
                <h3>Compare multiple samples</h3>
                <p>If you have multiple samples, compare their basic properties:</p>
                <pre><code># List all samples and their read counts
for f in raw_data/*_1.fastq.gz; do
    count=$(zcat $f | wc -l | awk '{print $1/4}')
    echo "$(basename $f): $count reads"
done

# Or use SeqKit for a cleaner comparison
seqkit stats raw_data/*_1.fastq.gz -T | column -t</code></pre>
            </div>
        </section>

        <section>
            <h2>Summary</h2>
            <p>In this lab, you learned to:</p>
            <ul>
                <li>Navigate paired-end FASTQ files and verify read counts</li>
                <li>Understand FASTQ format structure and quality encoding</li>
                <li>Extract read information using command-line tools</li>
                <li>Work efficiently with large compressed files</li>
                <li>Use SeqKit to get comprehensive statistics on FASTQ files</li>
                <li>Compare multiple samples quickly</li>
            </ul>
        </section>

        <section>
            <h2>Next Steps</h2>
            <p>In <a href="lab3.html">Lab 3</a>, we will use specialized QC tools (FastQC, fastp) to perform comprehensive quality evaluation of our sequencing data.</p>
        </section>
    </main>

    <footer>
        <p>Bioinformatics Specialization Program 2026 - KAUST Academy</p>
    </footer>

    <script>
        function toggleNav() {
            document.getElementById('nav-menu').classList.toggle('show');
        }
    </script>
</body>
</html>
