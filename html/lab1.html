<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 1: Warm-up for Large-scale Analysis - Bioinformatics 2026</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="../index.html" class="logo">Bioinformatics Specialization Program - KAUST Academy</a>
            <button class="nav-toggle" onclick="toggleNav()">&#9776;</button>
            <ul id="nav-menu">
                <li><a href="../index.html">Home</a></li>
                <li><a href="schedule.html">Schedule</a></li>
                <li><a href="labs.html" class="active">Labs</a></li>
                <li><a href="projects.html">Projects</a></li>
                <li><a href="setup.html">Setup</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <div class="breadcrumbs">
            <a href="../index.html">Home</a> / <a href="labs.html">Labs</a> / Lab 1
        </div>

        <div class="lab-header">
            <h1>Lab 1: Warm-up for Large-scale Analysis & Genomic File Formats</h1>
            <p class="lab-meta">Day 1 | Duration: 90 minutes</p>
        </div>

        <section>
            <h2>Objectives</h2>
            <ul>
                <li>Familiarize with the training environment and Linux command line</li>
                <li>Access public genomics data resources (NCBI SRA, GEO)</li>
                <li>Download example RNA-seq datasets from public repositories</li>
                <li>Understand common genomics file formats (FASTQ, FASTA, GTF/GFF)</li>
            </ul>
        </section>

        <section>
            <h2>Background</h2>
            <p>In this lab, we will set up our working environment and download RNA-seq data that we will use throughout the program. We will work with data from a published study comparing gene expression between different conditions.</p>

            <div class="info-box note">
                <strong>Dataset for this course</strong>
                We will use a subset of RNA-seq data from a publicly available study. This dataset contains paired-end sequencing reads from control and treatment samples, allowing us to perform a complete differential expression analysis workflow.
            </div>
        </section>

        <section>
            <h2>Instructions</h2>

            <div class="step" data-step="1">
                <h3>Set up your working directory</h3>
                <p>First, create a dedicated directory structure for this course. This will help keep your files organized.</p>
                <pre><code># Create main project directory
mkdir -p ~/bioinformatics_course

# Create subdirectories for different stages
mkdir -p ~/bioinformatics_course/raw_data
mkdir -p ~/bioinformatics_course/qc_reports
mkdir -p ~/bioinformatics_course/trimmed_data
mkdir -p ~/bioinformatics_course/alignment
mkdir -p ~/bioinformatics_course/counts
mkdir -p ~/bioinformatics_course/results

# Navigate to your project directory
cd ~/bioinformatics_course

# Verify the structure
ls -la</code></pre>
            </div>

            <div class="step" data-step="2">
                <h3>Activate your conda environment</h3>
                <p>Make sure your bioinformatics conda environment is activated before running any tools.</p>
                <pre><code># Activate the environment
conda activate bioinformatics_course

# Verify tools are available
fastqc --version
samtools --version</code></pre>
                <div class="info-box tip">
                    <strong>Tip</strong>
                    If you haven't set up your environment yet, please refer to the <a href="setup.html">Environment Setup</a> page first.
                </div>
            </div>

            <div class="step" data-step="3">
                <h3>Explore public genomics resources</h3>
                <p>The NCBI Sequence Read Archive (SRA) is a major repository for high-throughput sequencing data. Let's explore it:</p>
                <ul>
                    <li><strong>SRA:</strong> <a href="https://www.ncbi.nlm.nih.gov/sra" target="_blank">https://www.ncbi.nlm.nih.gov/sra</a></li>
                    <li><strong>GEO:</strong> <a href="https://www.ncbi.nlm.nih.gov/geo/" target="_blank">https://www.ncbi.nlm.nih.gov/geo/</a></li>
                    <li><strong>ENA:</strong> <a href="https://www.ebi.ac.uk/ena" target="_blank">https://www.ebi.ac.uk/ena</a></li>
                </ul>
                <p>Each dataset in SRA has a unique accession number (e.g., SRR1234567). You can search for datasets by organism, study type, or keywords.</p>
            </div>

            <div class="step" data-step="4">
                <h3>Download RNA-seq data using SRA Toolkit</h3>
                <p>We will download a subset of reads for demonstration. The SRA Toolkit provides tools to download and convert SRA data to FASTQ format.</p>
                <pre><code># Navigate to raw data directory
cd ~/bioinformatics_course/raw_data

# Download a sample dataset using prefetch (downloads .sra file)
# Replace SRR_ACCESSION with the actual accession number provided
prefetch SRR_ACCESSION

# Convert SRA to FASTQ format (for paired-end data)
fastq-dump --split-files --gzip SRR_ACCESSION

# For faster downloads, you can use fasterq-dump instead
fasterq-dump --split-files SRR_ACCESSION
gzip *.fastq  # Compress the output files</code></pre>
                <div class="info-box note">
                    <strong>Note</strong>
                    The actual accession numbers will be provided during the course. For demonstration, we're using placeholder values.
                </div>
            </div>

            <div class="step" data-step="5">
                <h3>Download reference files</h3>
                <p>We also need reference genome and annotation files. These can be downloaded from Ensembl or UCSC.</p>
                <pre><code># Create a references directory
mkdir -p ~/bioinformatics_course/references
cd ~/bioinformatics_course/references

# Download human reference genome (chromosome 22 for demo - smaller file)
wget https://ftp.ensembl.org/pub/release-110/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.chromosome.22.fa.gz

# Download gene annotation file (GTF)
wget https://ftp.ensembl.org/pub/release-110/gtf/homo_sapiens/Homo_sapiens.GRCh38.110.gtf.gz

# Uncompress the files
gunzip *.gz

# Check the files
ls -lh</code></pre>
            </div>

            <div class="step" data-step="6">
                <h3>Explore file formats</h3>
                <p>Let's examine the structure of common bioinformatics file formats.</p>

                <h4>FASTQ Format</h4>
                <p>FASTQ files contain sequencing reads with quality scores. Each read has 4 lines:</p>
                <pre><code># View first few reads (4 lines per read)
zcat raw_data/SRR*_1.fastq.gz | head -8

# Output structure:
# Line 1: @ReadID (header starting with @)
# Line 2: Sequence (ATCG...)
# Line 3: + (separator, sometimes repeats header)
# Line 4: Quality scores (ASCII characters)</code></pre>

                <h4>FASTA Format</h4>
                <p>FASTA files contain sequences without quality scores. Used for reference genomes.</p>
                <pre><code># View start of reference genome
head -5 references/Homo_sapiens.GRCh38.dna.chromosome.22.fa

# Output structure:
# Line 1: >chromosome/sequence ID
# Following lines: Sequence data</code></pre>

                <h4>GTF/GFF Format</h4>
                <p>GTF files contain gene annotations with 9 tab-separated fields.</p>
                <pre><code># View annotation file structure
head -50 references/Homo_sapiens.GRCh38.110.gtf | grep -v "^#"

# Fields: seqname, source, feature, start, end, score, strand, frame, attributes</code></pre>
            </div>

            <div class="step" data-step="7">
                <h3>Basic file statistics</h3>
                <p>Let's gather some basic statistics about our data.</p>
                <pre><code># Count number of reads in a FASTQ file
# Each read = 4 lines, so divide line count by 4
zcat raw_data/SRR*_1.fastq.gz | wc -l | awk '{print $1/4}'

# Check file sizes
ls -lh raw_data/

# Count genes in annotation file
grep -c "gene_id" references/Homo_sapiens.GRCh38.110.gtf</code></pre>
            </div>
        </section>

        <section>
            <h2>Summary</h2>
            <p>In this lab, you learned to:</p>
            <ul>
                <li>Set up an organized directory structure for bioinformatics projects</li>
                <li>Use SRA Toolkit to download public sequencing data</li>
                <li>Download reference genomes and annotations from Ensembl</li>
                <li>Understand FASTQ, FASTA, and GTF file formats</li>
                <li>Perform basic file inspection and statistics</li>
            </ul>
        </section>

        <section>
            <h2>Next Steps</h2>
            <p>In <a href="lab2.html">Lab 2</a>, we will explore the RNA-seq data in more detail and learn to navigate FASTQ files effectively.</p>
        </section>
    </main>

    <footer>
        <p>Bioinformatics Specialization Program 2026 - KAUST Academy</p>
    </footer>

    <script>
        function toggleNav() {
            document.getElementById('nav-menu').classList.toggle('show');
        }
    </script>
</body>
</html>
